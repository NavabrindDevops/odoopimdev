<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <menuitem
        id="menu_main_product"
        name="PIM Odoo"
        sequence='30'
        web_icon="pim_ext,static/description/icon.png"/>

<!--    <menuitem id="menu_productvariants"-->
<!--    action="product.product_normal_action_sell" name="Product List"-->
<!--    parent="menu_main_product"-->
<!--    sequence="1"/>-->

<!--    <menuitem name="Product Management"-->
<!--              id="menu_product_management2"-->
<!--              parent="menu_main_product"-->
<!--              action="product_management.product_product_mntn_action"-->
<!--              sequence="2"-->
<!--              groups="product_management.group_product_management_user,base.group_system"-->
<!--    />-->
        
    <menuitem id="menu_pim_attribute_action_product"
    action="product.product_template_action" name="Products"
    parent="menu_main_product" sequence="3"/>

    <menuitem id="pim_configuraion"
    name="Settings"
    parent="menu_main_product"
    sequence="100"/>


<!--    Family Attribute-->
        <record id="view_family_form" model="ir.ui.view">
            <field name="name">Family Group</field>
            <field name="model">family.attribute</field>
            <field name="arch" type="xml">
                <form string="Family Group" create="false" delete="false">
                    <!-- <header>
                        <button class="oe_stat_button" name="action_update" icon="fa-list-ul" type="object" string="Get Attribute Groups"/>
                    </header>-->
                    <sheet>
                        <style>
                            .o_group .o_wrap_label .o_form_label{font-weight:250; font-size:12px;}
                            .o_tag{font-size:var(--Tag-font-size, -2.1875rem);}
                        </style>
                        <div class="oe_title">
                            <h1><field name="name" class="oe_inline" readonly="1"/></h1>
                        </div>
                        <group>
                            <group>
                                <field name="name"/>
                                <field name="code" readonly="1"/>
                                <field name="description"/>
                            </group>
                        </group>


                      <group >

                      </group>
                    <notebook>
                        <page name="attibute_list" string="Attributes">
                            <br/>
                            <div style="display:flex; gap:10px; width:max-content;">
                                <button name="action_open_attribute_group_wizard" type="object"
                                      string="Add By Groups" class="oe_button btn-primary"/>
                                <button name="action_open_add_attribute_wizard" type="object" string="Add Attribute" class="oe_button btn-primary"/>
                            </div>
                            <br/>
                            <field name="product_families_ids">
                                <tree edit="false" create="false">
<!--                                    <control><create class="btn btn-primary" name="add_line_control" string="Add SKU(s)"/></control>-->
                                    <field name="product_id"/>
                                    <field name="product_id_stored"/>
                                    <field name="attribute_id"/>
                                    <field name="completeness_percent" widget="progressbar_extended" optional="hide"/>
                                </tree>
                            </field>
                        </page>
                        <page name="variant_rec" string="Variants">
                            <br/>
                            <div style="display:flex; gap:10px; width:max-content;">
                                <button name="action__add_variant_wizard" type="object" string="Add Variant" class="oe_button btn-primary"/>
                            </div>
                            <br/>
                            <field name="variant_line_ids">
                                <tree create="false" edit="false">
<!--                                    <field name="variant_id" string="Variant" invisible="1"/>-->
                                    <field name="name"/>
                                    <field name="variant_ids" string="Variants" widget="many2many_tags"/>
                                </tree>
                            </field>
                        </page>
                    </notebook>
                    </sheet>
                    <div class="oe_chatter">
                        <field name="message_follower_ids" groups="base.group_user"/>
                        <field name="activity_ids"/>
                        <field name="message_ids"/>
                    </div>
                </form>
            </field>
        </record>

        <record id="view_family_attribute_tree" model="ir.ui.view">
            <field name="name">Family</field>
            <field name="model">family.attribute</field>
            <field name="arch" type="xml">
                <tree string="Family Attribute" create="false">
                    <header>
                        <button name="create_pim_attribute_family" type="object" class="btn-primary"
                            string="Create Family" display="always"
                            invisible="context.get('active_model', 'family.attribute') != 'family.attribute'"/>
                    </header>
                    <field name="name"/>
                    <field name="code"/>
                    <field name="description"/>
                    <button name="edit_family" string = " " icon="fa-edit" type="object" />
                    <button name="delete_family" string = " " icon="fa-trash-o" type="object" />
                </tree>
            </field>
        </record>


    <record id="view_family_attribute_filter" model="ir.ui.view">
        <field name="name">Family Attribute Search</field>
        <field name="model">family.attribute</field>
        <field name="priority" eval="15"/>
        <field name="arch" type="xml">
            <search string="Family Attribute">
                <group expand="0" string="Group By">
                    <field name="name"/>
                    <field name="code"/>
                    <field name="description"/>
                    <filter string="Family Group Name" name="family_attribute" domain="[]" context="{'group_by': 'name'}"/>
                    <filter string="Code" name="family_code" domain="[]" context="{'group_by': 'code'}"/>
                </group>
            </search>
        </field>
    </record>

    <record id="action_family_view" model="ir.actions.act_window">
        <field name="name">Family</field>
        <field name="res_model">family.attribute</field>
        <field name="view_mode">tree,form</field>
        <field name="search_view_id" ref="view_family_attribute_filter"/>
        <field name="context">{'search_default_name': 1}</field>
    </record>



    <!--  Attribute Group-->
        <record id="view_attribute_group_form" model="ir.ui.view">
            <field name="name">Attribute Group Form</field>
            <field name="model">attribute.group</field>
            <field name="arch" type="xml">
                <form string="Attribute Group">
                    <sheet>
                        <group>
                            <field name="name" placeholder="eg.Technical Specifications"/>
                            <field name="attribute_family_id" widget="many2many_tags"/>
                        </group>

                        <notebook>
                            <page>
                                <field name="attributes_ids" mode="tree,form">
                                    <tree string="Attribute">
                                        <field name="name"/>
                                    </tree>
                                </field>
                            </page>
                        </notebook>
                    </sheet>
                     <div class="oe_chatter">
                        <field name="message_follower_ids" groups="base.group_user"/>
                        <field name="activity_ids"/>
                        <field name="message_ids"/>
                    </div>
                </form>
            </field>
        </record>

        <record id="view_attribute_group_tree" model="ir.ui.view">
            <field name="name">Attribute Group</field>
            <field name="model">attribute.group</field>
            <field name="arch" type="xml">
                <tree string="Attribute Group">
                    <field name="name"/>
                    <field name="active" widget="boolean_toggle"/>
                    <button name="attribute_group_open_form_view" type="object" icon="fa-pencil-square-o" class="btn-link"/>
                    <button name="attribute_group_unlink" type="object" icon="fa-trash" class="btn-link text-danger"/>
                </tree>
            </field>
        </record>


    <record id="view_attribute_group_filter" model="ir.ui.view">
        <field name="name">Attribute Group</field>
        <field name="model">attribute.group</field>
        <field name="priority" eval="15"/>
        <field name="arch" type="xml">
            <search string="Attribute Group">
                <field name="name"/>
                <group expand="0" string="Group By">
                    <filter string="Attribute Group Name" name="attribute_group" domain="[]" context="{'group_by': 'name'}"/>
                </group>
                <filter name="archived" string="Archived" domain="[('active', '=', False)]"/>
            </search>
        </field>
    </record>

    <record id="action_attribute_group_view" model="ir.actions.act_window">
        <field name="name">Attribute Groups</field>
        <field name="res_model">attribute.group</field>
        <field name="view_mode">tree,form</field>
        <field name="search_view_id" ref="view_attribute_group_filter"/>
        <field name="context">{'search_default_name': 1}</field>
    </record>

    <menuitem id="menu_pim_attribute_action"
              action="product.attribute_action" name="Attributes"
              parent="product_management.menu_product_management_conf" sequence="20"/>

    <menuitem id="menu_pim_attribute_action2"
              action="action_attribute_group_view" name="Attributes Groups"
              parent="product_management.menu_product_management_conf" sequence="10"/>

    <menuitem id="menu_pim_attribute_action3"
              action="action_family_view" name="Families"
              parent="product_management.menu_product_management_conf" sequence="30"/>


<!--    Inherit Attribute Form-->
    <record id="inherit_attribute" model="ir.ui.view">
        <field name="name">Attribute Form</field>
        <field name="model">product.attribute</field>
        <field name="inherit_id" ref="product.product_attribute_view_form"/>
        <field name="arch" type="xml">
            <xpath expr="//form//sheet" position="before">
                <header>
                    <button name="action_publish_attribute" type="object" string="Publish Attribute" class="btn-primary"
                            invisible="state != 'unpublish'"/>
<!--                    <button name="action_update_publish_attribute" type="object" string="Update Attribute" class="btn-primary"-->
<!--                            invisible="state != 'publish'"/>-->
                    <field name="state" widget="statusbar" statusbar_visible="unpublish,publish"/>
                </header>
            </xpath>
            <xpath expr="//field[@name='name']" position="after">
                <field name="attribute_group" options="{'no_create_edit': 1, 'no_quick_create': 1}"/>
                <field name="position_ref_field_id" options="{'no_create_edit': 1, 'no_quick_create': 1}"/>
                <field name="attribute_type_id" invisible="1"/>
            </xpath>
            <xpath expr="//form/sheet/group/group[1]/field[@name='display_type']" position="replace">
                <field name="display_type" readonly="1" string="Type"/>
            </xpath>
            <xpath expr="//form/sheet/group/group[@name='ecommerce_main_fields']/field[@name='visibility']" position="after">
<!--                <field name="attribute_types"/>-->
                <field name="original_name" invisible="1"/>
                <field name="is_mandatory" widget="boolean_toggle"/>
                <field name="is_required_in_clone" widget="boolean_toggle"/>
                <field name="is_cloning" widget="boolean_toggle"/>
                <field name="is_completeness" widget="boolean_toggle"/>


<!--                <field name="completed_in_percent" widget="progressbar"/>-->
            </xpath>
            <xpath expr="//field[@name='sequence']" position="before">
                <control><create class="btn btn-primary" name="add_line_control" string="Add Attribute Value"/></control>
            </xpath>
            <xpath expr="//field[@name='default_extra_price']" position="attributes">
                <attribute name="column_invisible">1</attribute>
            </xpath>
            <xpath expr="//field[@name='visibility']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            <xpath expr="//field[@name='create_variant']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            <xpath expr="//form" position="attributes">
                <attribute name="create">false</attribute>
            </xpath>
            <xpath expr="//form/sheet" position="after">
                <div class="oe_chatter">
                    <field name="message_follower_ids"/>
                    <field name="activity_ids"/>
                    <field name="message_ids" options="{'post_refresh': 'recipients'}"/>
                </div>
            </xpath>
            <xpath expr="//form/sheet/div" position="after">
                <div class="oe_title">
                    <h1>
                        <field name="name" readonly="1"/>
                    </h1>
                </div>
            </xpath>

            <xpath expr="//form/sheet/notebook/page[@name='attribute_values']" position="after">
                <page string="General Parameters" name="genral_params">
                    <form>
                        <sheet>
                            <group>
                                <group>
                                    <field name="code" readonly="1" string="Code"/>
                                    <field name="unique_value" readonly="1" string="Unique Value"/>
                                    <field name="value_per_channel" readonly="1" string="Value per channel"/>
                                </group>
                                <group>
                                    <field name="value_per_locale" readonly="1" string="Value per locale"/>
                                    <field name="usable_in_grid" readonly="1" string="Usable in grid"/>
                                    <field name="locale_specific" readonly="1" string="Locale specific"/>
                                </group>
                            </group>
                        </sheet>
                    </form>
                </page>
            </xpath>
        </field>
    </record>

    <record id="pim_product_attribute_search" model="ir.ui.view">
		<field name="name">pim.product.attribute.search</field>
		<field name="model">product.attribute</field>
		<field name="arch" type="xml">
			<search>
                <field name="name"/>
                <field name="display_type"/>
                <field name="attribute_group"/>
                <filter string="Mandatory" name="filter_mandatory" domain="[('is_mandatory', '=', True)]"/>
                <filter string="Required in clone" name="filter_required_in_clone" domain="[('is_required_in_clone', '=', True)]"/>
                <filter string="Cloning" name="filter_cloning" domain="[('is_cloning', '=', True)]"/>
                <filter string="Completeness" name="filter_completeness" domain="[('is_completeness', '=', True)]"/>
                <group expand="0" string="Group By">
                    <filter name="group_name" string="Name" domain="[]" context="{'group_by': 'name'}"/>
                    <filter name="group_attribute_rec" string="Attribute Group" domain="[]" context="{'group_by': 'attribute_group'}"/>
                    <filter name="group_attribute_type" string="Type" domain="[]" context="{'group_by': 'display_type'}"/>

                    <filter name="group_mandatory" string="Mandatory" domain="[]" context="{'group_by': 'is_mandatory'}"/>
                    <filter name="group_required_in_clone" string="Required in clone" domain="[]" context="{'group_by': 'is_required_in_clone'}"/>
                    <filter name="group_cloning" string="Cloning" domain="[]" context="{'group_by': 'is_cloning'}"/>
                    <filter name="group_completeness" string="Completeness" domain="[]" context="{'group_by': 'is_completeness'}"/>
                </group>
                <separator/>
<!--                <filter name="basic_attribute_type" string="Basic Attribute Type" domain="[('attribute_types', '=', 'basic')]"/>-->
<!--                <filter name="optional_attribute_type" string="Optional Attribute Type" domain="[('attribute_types', '=', 'optional')]"/>-->
			</search>
		</field>
	</record>

    <!--    Inherit Product} Form-->
    <record id="inherit_product" model="ir.ui.view">
        <field name="name">Product Form</field>
        <field name="model">product.product</field>
        <field name="inherit_id" ref="product.product_normal_form_view"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='default_code']" position="after">
                <field name="attribute_group_ids" widget="many2many_tags"/>
                <field name="attribute_family_ids" widget="many2many_tags"/>
            </xpath>
        </field>
    </record>

    <record id="inherit_product_attribute_tree_pim" model="ir.ui.view">
        <field name="name">inherit.product.attribute.tree.pim</field>
        <field name="model">product.attribute</field>
        <field name="inherit_id" ref="product.attribute_tree_view"/>
        <field name="arch" type="xml">
            <xpath expr="//tree" position="attributes">
                <attribute name="create">false</attribute>
            </xpath>
            <xpath expr="//tree" position="inside">
                <header>
                    <button name="create_pim_attribute_type" type="object" class="btn-primary"
                            string="Create Attribute" display="always"
                            invisible="context.get('active_model', 'product.attribute') != 'product.attribute'"/>
                </header>
            </xpath>
            <xpath expr="//tree/field[@name='create_variant']" position="attributes">
                <attribute name="column_invisible">1</attribute>
            </xpath>
            <xpath expr="//field[@name='visibility']" position="attributes">
                <attribute name="column_invisible">1</attribute>
            </xpath>
            <xpath expr="//field[@name='display_type']" position="attributes">
                <attribute name="string">Type</attribute>
            </xpath>
            <xpath expr="//field[@name='display_type']" position="after">
                <field name="attribute_group"/>
<!--                <field name="attribute_types"/>-->
                <field name="is_mandatory" widget="boolean_toggle"/>
                <field name="is_required_in_clone" widget="boolean_toggle"/>
                <field name="is_cloning" widget="boolean_toggle"/>
                <field name="is_completeness" widget="boolean_toggle"/>
                <field name="state" widget="badge" decoration-success="state == 'publish'" decoration-danger="state == 'unpublish'"/>
<!--                <field name="completed_in_percent" widget="progressbar"/>-->

            </xpath>
        </field>
    </record>

    <record id="product_view_kanban_catalog1" model="ir.ui.view">
        <field name="name">product.view.kanban.catalog</field>
        <field name="model">product.product</field>
        <field name="arch" type="xml">
            <kanban records_draggable="0" js_class="product_kanban_catalog">
                <field name="id" invisible="1"/>
                <field name="default_code" invisible="1"/>
                <templates>
                    <t t-name="kanban-menu">
                        <a role="menuitem" type="edit" class="dropdown-item border-top-0">Edit</a>
                    </t>
                    <t t-name="kanban-box">
                        <div class="d-flex flex-grow-1">
                            <div class="o_kanban_image">
                                <img t-att-src="kanban_image('product.product', 'image_128', record.id.raw_value)"
                                     alt="Product"/>
                            </div>
                            <div class="oe_kanban_details p-2 d-flex">
                                <div class="o_kanban_record_top flex-column m-0"
                                     t-attf-id="product-{{record.id.raw_value}}">
                                    <div class="d-flex">
                                        <field style="margin-top: 2px;" class="me-1" name="priority" widget="priority"/>
                                        <h4 class="text-reset">
                                            <strong class="o_kanban_record_title"><field name="name"/></strong>
                                        </h4>
                                    </div>
                                    <div t-if="record.default_code.value">
                                        [<field name="default_code"/>]
                                    </div>
                                    <!-- Used by @web/product/js/product_catalog/order_line to
                                         show the price using a t-portal. -->
                                    <div name="o_kanban_price"
                                         t-attf-id="product-{{record.id.raw_value}}-price"
                                         class="d-flex flex-column"/>
                                    <field name="product_template_attribute_value_ids"
                                           widget="many2many_tags"
                                           domain="[('id', 'in', parent.ids)]"
                                           groups="product.group_product_variant"
                                           options="{'color_field': 'color'}"/>
                                </div>
                            </div>
                        </div>
                    </t>
                </templates>
            </kanban>
        </field>
    </record>

    <record id="view_attribute_group_unlink_wizard_form" model="ir.ui.view">
        <field name="name">attribute.group.unlink.wizard.form</field>
        <field name="model">attribute.group.unlink.wizard</field>
        <field name="arch" type="xml">
            <form string="Confirm Deletion">
                <group>
                    <div style="justify-content: center; align-items: center; white-space: nowrap; margin: 10px 0;">
                        <p style="margin: 0; font-size: 14px;">
                            Are you sure you want to delete this attribute group?
                        </p>
                    </div>
                </group>
                <footer>
                    <button string="Cancel" class="btn-secondary" special="cancel"/>
                    <button string="Delete" class="btn-primary" type="object" name="confirm_unlink"/>
                </footer>
            </form>
        </field>
    </record>

    <record id="product_view_search_catalog1" model="ir.ui.view">
        <field name="name">product.view.search.catalog</field>
        <field name="model">product.product</field>
        <field name="arch" type="xml">
            <search string="Product">
                <!-- Search field -->
                <field name="name"
                       string="Product"
                       filter_domain="['|', '|', ('default_code', 'ilike', self), ('name', 'ilike', self), ('barcode', 'ilike', self)]"/>
                <field name="attribute_group_ids"/>
                <field name="attribute_family_ids"/>
                <field name="product_template_attribute_value_ids"
                       groups="product.group_product_variant"/>
                <field name="product_tmpl_id" string="Product Template"/>
                <!-- Filter -->
                <filter string="Favorites" name="favorites" domain="[('priority', '=', '1')]"/>
                <separator/>
                <filter string="Services" name="services" domain="[('type', '=', 'service')]"/>
                <filter string="Products"
                        name="products"
                        domain="[('type', 'in', ['consu', 'product'])]"/>
                <!-- Group By -->
                <group expand="1" string="Group By">
                    <filter string="Product Type" name="type" context="{'group_by':'type'}"/>
                    <filter string="Product Category"
                            name="categ_id"
                            context="{'group_by':'categ_id'}"/>
                </group>
                <!-- searchpanel -->
                <searchpanel>
                    <field name="attribute_family_ids" string="Family" icon="fa-th-list" enable_counters="1" select="multi"/>
                    <field name="attribute_group_ids" string="Attributes Group" icon="fa-th-list" enable_counters="1" select="multi"/>
                    <field name="product_template_attribute_value_ids" string="Attribute &amp; Values" icon="fa-th-list" enable_counters="1" select="multi"/>
                </searchpanel>
            </search>
        </field>
    </record>

    <record id="action_product_list_variants" model="ir.actions.act_window">
        <field name="name">List Product</field>
        <field name="res_model">product.product</field>
        <field name="view_mode">kanban</field>
        <field name="search_view_id" ref="product_view_search_catalog1"/>
        <field name="context">{}</field>
    </record>

<!--    <menuitem id="menu_product_variants_list"-->
<!--    action="action_product_list_variants" name="List Product"-->
<!--    parent="menu_main_product" sequence="1"/>-->

    <menuitem id="menu_product_pricelist_main_2"
        name="Manage Pricelists"
        action="product.product_pricelist_action2"
        groups="product.group_product_pricelist"
        parent="pim_configuraion"
        sequence="1"/>



</odoo>
